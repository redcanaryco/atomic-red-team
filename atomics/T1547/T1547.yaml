attack_technique: T1547
display_name: 'Boot or Logon Autostart Execution'
atomic_tests:
- name: Add a driver
  auto_generated_guid: cb01b3da-b0e7-4e24-bf6d-de5223526785
  description: |
    Install a driver via pnputil.exe lolbin
  supported_platforms:
  - windows
  input_arguments:
    driver_inf:
      description: A built-in, already installed windows driver inf
      type: path
      default: 'C:\Windows\INF\usbstor.inf'
  executor:
    command: |
      pnputil.exe /add-driver "#{driver_inf}"
    name: command_prompt

- name: Driver Installation Using pnputil.exe
  description: |
    pnputil.exe is a native command-line utility in Windows to install drivers, this can be abused by to install malicious drivers. Ref: https://lolbas-project.github.io/lolbas/Binaries/Pnputil/
  supported_platforms:
  - windows
  input_arguments:
    driver_path:
      description: Enter the driver file path to install (Default is used built-in windows driver - acpipmi.inf)
      type: path
      default: C:\Windows\INF\acpipmi.inf
  executor:
    command: |
      pnputil.exe -i -a #{driver_path}
    name: powershell
