---
attack_technique: T1107
display_name: File Deletion

atomic_tests:
- name: Victim configuration
  description: |
    xxx
  supported_platforms:
    - linux
  executor: sh
  command: |
    mkdir /tmp/victim-files
    cd /tmp/victim-files
    touch a b c d e f g
    echo "This file will be shredded" > /tmp/victim-shred.txt

- name: Delete a single file
  description: |
    xxx
  supported_platforms:
    - linux
  executor: sh
  command: rm -f /tmp/victim-files/a

- name: Delete an entire folder
  description: |
    xxx
  supported_platforms:
    - linux
  executor: sh
  command: rm -rf /tmp/victim-files

- name: Overwrite and delete a file with shred
  description: |
    xxx
  supported_platforms:
    - linux
  executor: sh
  command: shred -u /tmp/victim-shred.txt

- name: Victim configuration
  description: |
    xxx
  supported_platforms:
    - windows
  executor: command_prompt
  command: |
    mkdir %TEMP%\victim-files-cmd
    cd %TEMP%\victim-files-cmd
    type nul > a
    type nul > b
    type nul > c
    type nul > d
    type nul > e
    type nul > f
    type nul > g
    mkdir %TEMP%\victim-files-ps
    cd %TEMP%\victim-files-ps
    type nul > a
    type nul > b
    type nul > c
    type nul > d
    type nul > e
    type nul > f
    type nul > g

- name: Delete a single file - cmd
  description: |
    xxx
  supported_platforms:
    - windows
  executor: command_prompt
  command: del /f %TEMP%\victim-files-cmd\a

- name: Delete an entire folder - cmd
  description: |
    xxx
  supported_platforms:
    - windows
  executor: command_prompt
  command: del /f /S %TEMP%\victim-files-cmd

- name: Delete a single file - ps
  description: |
    xxx
  supported_platforms:
    - windows
  executor: command_prompt
  command: Remove-Item -path %TEMP%\victim-files-ps\a

- name: Delete an entire folder - ps
  description: |
    xxx
  supported_platforms:
    - windows
  executor: command_prompt
  command: Remove-Item -path %TEMP%\victim-files-ps -recurse

- name: Delete VSS - vssadmin
  description: |
    xxx
  supported_platforms:
    - windows
  executor: command_prompt
  command: vssadmin.exe Delete Shadows /All /Quiet

- name: Delete VSS - wmic
  description: |
    xxx
  supported_platforms:
    - windows
  executor: command_prompt
  command: wmic shadowcopy delete

- name: bcdedit
  description: |
    xxx
  supported_platforms:
    - windows
  executor: command_prompt
  command: |
    bcdedit /set {default} bootstatuspolicy ignoreallfailures
    bcdedit /set {default} recoveryenabled no

- name: wbadmin
  description: |
    xxx
  supported_platforms:
    - windows
  executor: command_prompt
  command: wbdadmin delete catalog -quiet
