attack_technique: T1652
display_name: "Device Driver Discovery"
atomic_tests:

- name: Device Driver Discovery
  auto_generated_guid: 235b30a2-e5b1-441f-9705-be6231c88ddd
  description: |
    Displays a list of installed device drivers on the local computer and their properties. Threat actors use this command to enumerate the existing drivers on the computer. 
    Parameters: 
    /v /fo list - Displays verbose output in a list format - the /v parameter is not valid for signed drivers
    /si /fo list - Provides information about signed drivers and outputs it in a list format
  supported_platforms:
  - windows
  executor:
    command: |
      driverquery /v /fo list
      driverquery /si /fo list
    cleanup_command: 
    name: powershell
    elevation_required: false
- name: Device Driver Discovery (Linux)
  description: |
    Displays a list of loaded kernel modules on a Linux system, which is used to enumerate drivers.
  supported_platforms:
  - linux
  executor:
    command: |
      lsmod
    cleanup_command:
    name: bash
    elevation_required: false
- name: Enumerate Kernel Driver Files (Linux)
  description: |
    Finds and lists all kernel driver files on a Linux system in order to provide a broader view of available drivers, not just loaded ones.
  supported_platforms:
  - linux
  executor:
    command: |
      find /lib/modules/$(uname -r)/kernel/drivers -name "*.ko*"
    cleanup_command:
    name: bash
    elevation_required: false
- name: Device Driver Discovery (macOS)
  description: |
    Displays a list of loaded kernel extensions (kexts) on a macOS system.
  supported_platforms:
  - macos
  executor:
    command: |
      kextstat
    cleanup_command:
    name: bash
    elevation_required: false
- name: Find Kernel Extensions (macOS)
  description: |
    Searches for kernel extension (kext) files on a macOS system.
  supported_platforms:
  - macos
  executor:
    command: |
      kextfind
    cleanup_command:
    name: bash
    elevation_required: false
