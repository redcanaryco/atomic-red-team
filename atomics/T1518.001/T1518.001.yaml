attack_technique: T1518.001
display_name: Software Discovery: Security Software Discovery
atomic_tests:
- name: Security Software Discovery
  description: |
    Methods to identify Security Software on an endpoint

    when sucessfully executed, the test is going to display running processes, firewall configuration on network profiles
    and specific security software.
  supported_platforms:
  - windows
  executor:
    command: |
      netsh.exe advfirewall  show allprofiles
      tasklist.exe
      tasklist.exe | findstr /i virus
      tasklist.exe | findstr /i cb
      tasklist.exe | findstr /i defender
      tasklist.exe | findstr /i cylance
    name: command_prompt
- name: Security Software Discovery - powershell
  description: |
    Methods to identify Security Software on an endpoint

    when sucessfully executed, powershell is going to processes related AV products if they are running.
  supported_platforms:
  - windows
  executor:
    command: |
      get-process | ?{$_.Description -like "*virus*"}
      get-process | ?{$_.Description -like "*carbonblack*"}
      get-process | ?{$_.Description -like "*defender*"}
      get-process | ?{$_.Description -like "*cylance*"}
    name: powershell
- name: Security Software Discovery - ps
  description: |
    Methods to identify Security Software on an endpoint
    when sucessfully executed, command shell  is going to display AV software it is running( Little snitch or carbon black ).
  supported_platforms:
  - linux
  - macos
  executor:
    command: |
      ps -ef | grep Little\ Snitch | grep -v grep
      ps aux | grep CbOsxSensorService
    name: sh
- name: Security Software Discovery - Sysmon Service
  description: |
    Discovery of an installed Sysinternals Sysmon service using driver altitude (even if the name is changed).

    when sucessfully executed, the test is going to display sysmon driver instance if it is installed.
  supported_platforms:
  - windows
  executor:
    command: |
      fltmc.exe | findstr.exe 385201
    name: command_prompt
    elevation_required: true
- name: Security Software Discovery - AV Discovery via WMI
  description: |
    Discovery of installed antivirus products via a WMI query.

    when sucessfully executed, the test is going to display installed AV software.
  supported_platforms:
  - windows
  executor:
    command: wmic.exe /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List
    name: command_prompt
    elevation_required: true

