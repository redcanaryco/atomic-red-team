{
  "Query Registry": {
    "MITRE ATT&CK Technique:": "[T1012](https://attack.mitre.org/wiki/Technique/T1012)",
    "Input": "reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\"\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\nreg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices\nreg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\nreg query HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit\nreg query HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\\Shell\nreg query HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\\Shell\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellServiceObjectDelayLoad\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nreg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nreg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\nreg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\n",
    "Use the following command (as Administrator) to view the drivers configured to load during startup:": "reg query hklm\\system\\currentcontrolset\\services /s | findstr ImagePath 2>nul | findstr /Ri \".*\\.sys$\"\n\nReg Query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nreg save HKLM\\Security security.hive (Save security hive to a file)\nreg save HKLM\\System system.hive (Save system hive to a file)\nreg save HKLM\\SAM sam.hive (Save sam to a file)=\nreg add [\\\\TargetIPaddr\\] [RegDomain][ \\Key ]\nreg export [RegDomain]\\[Key] [FileName]\nreg import [FileName ]\nreg query [\\\\TargetIPaddr\\] [RegDomain]\\[ Key ] /v [Valuename!] (you can to add /s for recurse all values )\n",
    "References:": "https://blog.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order \n https://blog.cylance.com/windows-registry-persistence-part-1-introduction-attack-phases-and-windows-services \n http://www.handgrep.se/repository/cheatsheets/postexploitation/WindowsPost-Exploitation.pdf \n https://www.offensive-security.com/wp-content/uploads/2015/04/wp.Registry_Quick_Find_Chart.en_us.pdf"
  }
}
